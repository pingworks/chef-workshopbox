apiVersion: v1
kind: PersistentVolume
metadata:
  name: pv-gitlab-gitlab
  namespace: infra
  labels:
    app: gitlab
    container: gitlab
spec:
  capacity:
    storage: 1Gi
  accessModes:
    - ReadWriteOnce
  persistentVolumeReclaimPolicy: Retain
  nfs:
    path: /data/nfs/infra/gitlab/gitlab
    server: <%= node['ipaddress'] %>

---

apiVersion: v1
kind: PersistentVolume
metadata:
  name: pv-gitlab-postgresql
  namespace: infra
  labels:
    app: gitlab
    container: postgresql
spec:
  capacity:
    storage: 1Gi
  accessModes:
    - ReadWriteOnce
  persistentVolumeReclaimPolicy: Retain
  nfs:
    path: /data/nfs/infra/gitlab/postgresql
    server: <%= node['ipaddress'] %>

---

apiVersion: v1
kind: PersistentVolume
metadata:
  name: pv-gitlab-redis
  namespace: infra
  labels:
    app: gitlab
    container: redis
spec:
  capacity:
    storage: 1Gi
  accessModes:
    - ReadWriteOnce
  persistentVolumeReclaimPolicy: Retain
  nfs:
    path: /data/nfs/infra/gitlab/redis
    server: <%= node['ipaddress'] %>

---

apiVersion: v1
kind: PersistentVolume
metadata:
  name: pv-gitlab-registry
  namespace: infra
  labels:
    app: gitlab
    container: registry
spec:
  capacity:
    storage: 5Gi
  accessModes:
    - ReadWriteOnce
  persistentVolumeReclaimPolicy: Retain
  nfs:
    path: /data/nfs/infra/gitlab/registry
    server: <%= node['ipaddress'] %>
